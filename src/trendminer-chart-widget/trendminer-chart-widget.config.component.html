<div>
    <div class="configSection">
        <label for="TrendminerChartWidgetConfig">
            Trendminer Configuration
        </label>
        <!-- 
            Basic config for tren miner access - for example basic url (proxy or direct) 
            timeseries to show, dates etc...
        -->
        <div class="col-lg-12 col-layout">
            <div class="input-group mb-1">
                <div class="input-group-prepend">
                    <span class="input-group-text help-icon" id="basic-addon1">
                        Address
                        <img src="{{CONST_HELP_IMAGE_FILE}}" alt="help tooltip"
                             title="enter the proxy prefix for api calls to trendminer .">

                    </span>
                </div>
                <input class="form-control" type="text"
                       name="proxy" [(ngModel)]="widgetHelper.getWidgetConfig().proxy" (change)="onConfigChanged()">
            </div>
        </div>
        <!-- 
            time series selection
        -->
        <div class="row form-group">
            <div class="col-lg-6">
                <label class="label-with-help" for="TrendminerChartWidget-myValue">
                    select one or more series to chart
                    <span class="help-icon">
                        <img src="{{CONST_HELP_IMAGE_FILE}}" alt="help tooltip"
                             title="Select one or more time series for the chart.">
                    </span>
                    <ng-select
                               [items]="items$ | async"
                               bindLabel="name"
                               [closeOnSelect]="true"
                               [multiple]="true"
                               [hideSelected]="true"
                               [typeahead]="input$"
                               [(ngModel)]="widgetHelper.getWidgetConfig().seriesNames"
                               (change)="onConfigChanged()">
                    </ng-select>
                </label>
            </div>
        </div>
        <!-- 
            Date ranges
        -->
        <div class="row form-group">
            <div class="col-lg-6 col-layout">
                <div class="input-group mb-1">
                    <div class="input-group-prepend">
                        <span class="input-group-text help-icon" id="basic-addon1">
                            start date
                            <img src="{{CONST_HELP_IMAGE_FILE}}" alt="help tooltip"
                                 title="Choose the start date and time for the chart.">

                        </span>
                    </div>
                    <input class="form-control" type="date" id="startDate" name="startDate"
                           value="widgetHelper.getWidgetConfig().startDate"
                           [(ngModel)]="widgetHelper.getWidgetConfig().startDate"
                           (change)="onConfigChanged(true)">
                    <input class="form-control" type="time" id="startTime" name="startTime"
                           value="widgetHelper.getWidgetConfig().startTime"
                           [(ngModel)]="widgetHelper.getWidgetConfig().startTime"
                           (change)="onConfigChanged(true)">
                </div>

            </div>
            <div class="col-lg-6 col-layout">
                <div class="input-group mb-1">
                    <div class="input-group-prepend">
                        <span class="input-group-text help-icon" id="basic-addon1">
                            end date
                            <img src="{{CONST_HELP_IMAGE_FILE}}" alt="help tooltip"
                                 title="Select the end date and time for the chart.">

                        </span>
                    </div>
                    <input class="form-control" type="date" id="endDate" name="endDate"
                           value="widgetHelper.getWidgetConfig().endDate"
                           [(ngModel)]="widgetHelper.getWidgetConfig().endDate" (change)="onConfigChanged(true)">
                    <input class="form-control" type="time" id="endTime" name="endTime"
                           value="widgetHelper.getWidgetConfig().endTime"
                           [(ngModel)]="widgetHelper.getWidgetConfig().endTime"
                           (change)="onConfigChanged(true)">
                </div>

            </div>

        </div>

    </div>

    <!-- 
        next section chart details 
    -->
    <ng-container *ngIf="widgetHelper.getWidgetConfig().hasSeries()">
        <div class="configSection">
            <label for="TrendminerChartWidgetConfig">
                Chart Options
            </label>
            <div class="row">
                <div class="col-lg-6">
                    <label class="label-with-help" for="chartSelector" translate> Chart labels
                        <span class="help-icon">
                            <img src="{{CONST_HELP_IMAGE_FILE}}" alt="help tooltip"
                                 title="What unit to divide and label the x-axis with.">
                        </span>
                        <ng-select
                                   [items]="widgetHelper.getWidgetConfig().units"
                                   [closeOnSelect]="true"
                                   [multiple]="false"
                                   [hideSelected]="true"
                                   [(ngModel)]="widgetHelper.getWidgetConfig().chartUnit"
                                   (change)="onConfigChanged()">
                        </ng-select>

                    </label>
                </div>
            </div>
            <div class="row">
                <!-- Show Context Items -->
                <div class="form-check-inline col-lg-2">
                    <label class="label-with-help" class="form-check-label" for="contextFlag" translate>
                        <input class="form-check-input" type="checkbox" name="fillArea"
                               [(ngModel)]="widgetHelper.getWidgetConfig().showContext"
                               (ngModelChange)="onConfigChanged()" /> Show context events<span class="help-icon">
                            <img src="{{CONST_HELP_IMAGE_FILE}}" alt="help tooltip"
                                 title="Show context events on the chart for the chosen range.">
                        </span>
                    </label>
                </div>

                <!-- Fill under line -->
                <div class="form-check-inline col-lg-2">
                    <label class="label-with-help" class="form-check-label" for="fillArea" translate>
                        <input class="form-check-input" type="checkbox" name="fillArea"
                               [(ngModel)]="widgetHelper.getWidgetConfig().fillArea"
                               (ngModelChange)="onConfigChanged()" /> Fill area<span class="help-icon">
                            <img src="{{CONST_HELP_IMAGE_FILE}}" alt="help tooltip"
                                 title="Fill the area under the line with the color of the series.">
                        </span>
                    </label>
                </div>
            </div>
            <div class="row">
                <!-- refresh -->
                <div class="form-group col-lg-12">
                    <div class="input-group mb-1">
                        <div class="input-group-prepend">
                            <input class="form-check-input" type="checkbox" name="beginAtZero2"
                                   [(ngModel)]="widgetHelper.getWidgetConfig().refresh"
                                   (ngModelChange)="onConfigChanged()" />
                            <span class="input-group-text" id="basic-addon2">
                                refresh every
                            </span>
                        </div>
                        <input class="form-control" type="text"
                               name="proxy" [(ngModel)]="widgetHelper.getWidgetConfig().refreshPeriodMinutes"
                               (change)="onConfigChanged()">
                        <div class="input-group-append">
                            <span class="input-group-text help-icon" id="basic-addon3">
                                minutes
                                <img src="{{CONST_HELP_IMAGE_FILE}}" alt="help tooltip"
                                     title="Check to allow the graph to update every N minutes.">
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </ng-container>

    <!-- next section series details -->
    <ng-container *ngIf="widgetHelper.getWidgetConfig().hasSeries()">
        <div class="configSection">
            <label for="TrendminerChartWidgetConfig">
                Series Options
            </label>

            <!-- Each series -->
            <ng-container *ngFor="let seriesKey of widgetHelper.getWidgetConfig().seriesKeys()">
                <!-- color -->
                <div class="row">
                    <div class=" col-lg-3">

                        <label for="TrendminerChartWidgetConfig">
                            {{seriesKey}}
                        </label>
                        <input class="form-control" type="color" [ngModelOptions]="{ standalone: true }"
                               [(ngModel)]="widgetHelper.getWidgetConfig().series[seriesKey].color"
                               [value]="widgetHelper.getWidgetConfig().series[seriesKey].color"
                               (ngModelChange)="onConfigChanged()" />
                    </div>
                </div>
            </ng-container>
        </div>
    </ng-container>
</div>